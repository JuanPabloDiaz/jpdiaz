---
import ArrowUp from '@components/icons/ArrowUp.astro';
---

<button
	data-testId="back-to-top-button"
	type="button"
	aria-label="back to top button"
	data-mdb-ripple="true"
	data-mdb-ripple-color="light"
	class="fixed bottom-5 right-5 inline-block rounded-full bg-black p-3 text-xs font-medium uppercase leading-tight shadow-md transition duration-300 ease-in-out hover:bg-orange hover:shadow-lg focus:outline-none focus:ring-0 dark:bg-orange dark:hover:bg-white dark:hover:text-black"
	id="btn-back-to-top"
>
	<ArrowUp />
</button>

<script is:inline>
  // Show/hide button and scroll to top using safe event listeners
  window.addEventListener('DOMContentLoaded', () => {
    const mybutton = document.getElementById('btn-back-to-top');
    if (!mybutton) return;

    // Show/hide logic
    const scrollFunction = () => {
      if (window.scrollY > 20) {
        mybutton.style.display = 'block';
      } else {
        mybutton.style.display = 'none';
      }
    };
    window.addEventListener('scroll', scrollFunction, { passive: true });
    scrollFunction(); // Initial state

    // Scroll to top
    mybutton.addEventListener('click', (event) => {
      event.preventDefault();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Cleanup on Astro navigation
    document.addEventListener('astro:before-swap', () => {
      window.removeEventListener('scroll', scrollFunction);
    });
  });
</script>
